#!/usr/bin/env php
<?php

if (!class_exists("Imagick")) {
    echo "Error: You need Imagick." . PHP_EOL;
    exit(1);
}

if (count($argv) < 2) {
    echo "Usage: lgtmify <filename|url>" . PHP_EOL;
    exit(1);
}

$lgtm_png_data = "iVBORw0KGgoAAAANSUhEUgAAAtQAAADECAYAAAC/ZLZCAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJ
bWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdp
bj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6
eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0
NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJo
dHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlw
dGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAv
IiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RS
ZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpD
cmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFu
Y2VJRD0ieG1wLmlpZDowRURFREU3MzE0MDAxMUU0QjJEMTk4RDkwQzhGMkZGRSIgeG1wTU06RG9j
dW1lbnRJRD0ieG1wLmRpZDowRURFREU3NDE0MDAxMUU0QjJEMTk4RDkwQzhGMkZGRSI+IDx4bXBN
TTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjBFREVERTcxMTQwMDExRTRC
MkQxOThEOTBDOEYyRkZFIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjBFREVERTcyMTQwMDEx
RTRCMkQxOThEOTBDOEYyRkZFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4
bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+DG7AhQAAIdpJREFUeNrs3QmUVcWZwPHqsMgmW4Nb
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
";

$filename = $argv[1];

$tempfile = tempnam(sys_get_temp_dir(), 'lgtmstamp.');
$tempfile_lgtm_png = tempnam(sys_get_temp_dir(), 'lgtmstamp_png.');

file_put_contents($tempfile, file_get_contents($filename));
file_put_contents($tempfile_lgtm_png, base64_decode($lgtm_png_data));

$out_filename = pathinfo($filename, PATHINFO_FILENAME) . '_lgtm.' . pathinfo($filename, PATHINFO_EXTENSION);

$image = new Imagick();
$image->readImage($tempfile);

$width = $image->getImageWidth();
$height = $image->getImageHeight();

$filter = 1;
$blur = 0.8;


$lgtm_image = new Imagick();
$lgtm_image->readImage($tempfile_lgtm_png);
$lgtm_image->resizeImage($width / 2, 0, $filter, $blur);

if ($image->getNumberImages() > 1) {
    $image->setFirstIterator();
    $image = $image->coalesceImages();
    do {
        $image->compositeImage($lgtm_image, Imagick::COMPOSITE_DEFAULT, $width / 4, $height / 2);
    } while ($image->nextImage());
    $image = $image->deconstructImages();
    $image->writeImages($out_filename, true);
} else {
    $image->compositeImage($lgtm_image, Imagick::COMPOSITE_DEFAULT, $width / 4, $height / 2);
    $image->writeImage($out_filename);
}

$image->clear();
$lgtm_image->clear();

echo "{$out_filename} created." . PHP_EOL;

unlink($tempfile);
unlink($tempfile_lgtm_png);
